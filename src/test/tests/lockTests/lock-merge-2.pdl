pipe ex2(in: bool)[rf: int<32>[5]] {
    start(rf);
    int<5> addr = 1<5>;
    if (in) {
        reserve(rf[addr]);
    }
    ---
    int<5> addr2 = 2<5>;
    bool cond2 = true;
    if (cond2) {
        reserve(rf[addr2]);
    }
    ---
    if (in) {
        block(rf[addr]);
        release(rf[addr]);
    }
    end(rf);
    ---
    if (cond2) {
        block(rf[addr2]);
        release(rf[addr2]);
    }
}

circuit {
    r1 = memory(int<32>, 5);
    e = new ex2[r1];
    call e(true);
}