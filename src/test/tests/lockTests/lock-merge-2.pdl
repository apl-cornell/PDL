pipe ex2(in: bool)[rf: int<32>[5]] {
    start(rf);
    uint<5> addr = u1<5>;
    if (in) {
        reserve(rf[addr], R);
    }
    ---
    uint<5> addr2 = u2<5>;
    bool cond2 = true;
    if (cond2) {
        reserve(rf[addr2], R);
    }
    ---
    if (in) {
        block(rf[addr]);
        release(rf[addr]);
    }
    end(rf);
    ---
    if (cond2) {
        block(rf[addr2]);
        release(rf[addr2]);
    }
}

circuit {
    t1 = memory(int<32>, 5);
    r1 = Queue(t1);
    e = new ex2[r1];
    call e(true);
}